---
Date: 2016/09/22
Student ID: 0110111
Name: 楊証棨
---

# Lab 01 Linux Environment

## Topic

熟悉 Linux 環境

## Goal

- 熟悉 putty 遠端連線登入、基本操作指令、修改密碼。
- 熟悉 vim 的操作指令。
- 使用 Makefile 自動編譯 C/C++，提高開發程式的效率。


## Experiments

### LAB01-1: Linux 指令運用

運用 Linux 建立以下的目錄和檔案。

```
LAB01
|--lab01-2
|  |--Makefile
|  `--lab01-2.c
|--lab01-3
|  |--Makefile
|  `--lab01-3.c
`--lab01-4
   |--Makefile
   `--lab01-4.c
```

```shell
mkdir LAB01
mkdir LAB01/lab01-2
touch LAB01/lab01-2/Makefile

```

### LAB01-2: Triangle Wave

根據所給的振幅 (Amplitude) 及頻率 (Frequency)，產生這樣的波。

想法：利用絕對值的概念，從波峰的地方為起點，往越往外所產生的高度要越少。

```c
#include <stdio.h>

void func(int t) {
  int i;
  for(i = 0; i < t; ++i){
    printf("%d", t);
  }
  printf("\n");
}

int main() {
  int n, a, f;
  scanf("%d", &n);
  while (n--) {
    scanf("%d %d", &a, &f);

    int distance, i, j;
    for(i = 0; i < f; ++i){
      for(j = 0; j < (a * 2); ++j){
        distance = (j - a > 0) ? j - a : a - j ;    // 計算與波峰距離
        func(a - distance);                         // 越遠波的幅度越小
      }
      func(0);
    }
  }
  return 0;
}
```

### LAB01-3: Credit Check

驗證信用卡，依照講義驗證說明實作即可完成。

```c
#include <stdio.h>

int f(int e){                                          // 計算每個數字的和
  return (e % 10) + ((e / 10) % 10);
}

int main() {
  while (1) {
    int key[4];

    scanf("%d", &key[0]);
    if(key[0] == -1) { break; }
    scanf("%d %d %d", &key[1], &key[2], &key[3]);

    int odd, even, i;
    odd = 0;
    even = 0;

    for(i = 0; i < 4; ++i) {
      odd += (key / 1 % 10) + (key / 100 % 10);         // 基數

      int e1, e2;
      e1 = f( 2 * (key /   10 % 10) );
      e2 = f( 2 * (key / 1000 % 10) );
      even += e1 + e2;                                  // 偶數
    }

    if( ((even + odd) % 10) ) {                         // 驗證
      printf("Invalid\n");
    }
    else {
      printf("Valid\n");
    }
  }
  return 0;
}
```

### LAB01-4: Numeral Game

```c
#include <stdio.h>

int f(int n) {                             // n 的因數和
  int rtn, factor;

  rtn = 0;
  factor = 1;
  while( factor <= n ) {
    if( n % factor == 0 ) {
      rtn += factor;
    }
    factor += 1;
  }
  return rtn;
}

int main() {
  int lines = 1;
  while (1) {
    int s;
    scanf("%d", &s);
    if (s==0) break;

    int i, factor;
    factor = -1;
    for(i = 1000; i >= 0; i--) {
      if(s == f(i)) {                       // 比對因數和與 s 是否相同
        factor = i;
        break;
      }
    }
    printf("Case %d: %d\n", lines, factor);
    lines += 1;
  }
  return 0;
}
```

### LAB01-5: 利用 Makefile 來編譯程式

由講義給的 Makefile Sample，更改 `SRC` `EXE` 兩個檔案名稱即可。

```shell
CC     = gcc
EXE    = TriangleWave
CFLAGS = -Wall -g -o $(EXE)
SRC    = lab01-2.c

all:
	$(CC) $(CFLAGS) $(SRC)
run:
	./$(EXE)
clean:
	rm -f $(EXE)
```


## Learned knowledge

### 登入 Server

使用 putty 登入 Server，設定以下參數：

| 欄位 | 參數 |
|:---------------:|:--------------:|
| Host Name       | 140.113.217.12 |
| Port            | 22             |
| Connection Type | SSH            |

或是在 Terminal 上執行以下的程式碼

```shell
ssh username@140.113.217.12
```

連線後輸入帳號密碼，即可使用工作站。

## Linux 常用指令

### passwd

修改密碼

```shell
$ passwd
```

然後按照指示輸入舊密碼、新密碼。

```
Old password: <type your old password here>
New password: <type your new password here>
Retype new password: <type your password here again>
```

### ls

列出目錄下的檔案名稱：

```shell
$ ls
examples.desktop  LAB01  Makefile

$ ls -la LAB01/
total 20
drwxr-xr-x 5 ESL_2016_01 ESL_2016 4096  9月 20 19:01 .
drwxr-x--- 4 ESL_2016_01 ESL_2016 4096  9月 20 20:10 ..
drwxr-xr-x 2 ESL_2016_01 ESL_2016 4096  9月 20 19:39 lab01-2
drwxr-xr-x 2 ESL_2016_01 ESL_2016 4096  9月 20 19:51 lab01-3
drwxr-xr-x 2 ESL_2016_01 ESL_2016 4096  9月 20 20:10 lab01-4
```

參數：

- `-a`: 列出全部檔案
- `-l`: 列出檔案目錄的相關資訊
- `-g`: 列出檔案所屬的 group 名稱
- `-F`: 列出各種不同類型的檔案 (`/` 為目錄，`*` 為可執行檔)
- `-s`: 在檔案前顯示其 block 大小,一般是以Kbyte為單位
- `-R`: 遞迴列出檔案及子目錄及其下的所有子目錄和檔案

### pwd [OPTION]

顯示目前工作目錄

```shell
pwd
```

```shell
$ pwd
/home/ESL_2016_01/LAB01/lab01-2
```

### cat, more, head, tail

列出檔案內容

```shell
cat [OPTION] [FILE]
more [-dlfpcsu] [-num] [+/pattern] [+linenum] [file ]
head [OPTION] [FILE]
tail [OPTION] [FILE]
```

```shell
cat  lab01-2.c
more lab01-2.c      # 自動分頁
head -3 lab01-2.c   # 列出前三行
tail -3 lab01-2.c   # 列出後三行
```

### rm

刪除檔案

```shell
rm [OPTION] FILE
```

```shell
rm a.out
```

### cp

複製檔案

```shell
cp [OPTION] [-T] SOURCE DEST
cp [OPTION] SOURCE DIRECTORY
cp [OPTION] -t DIRECTORY SOURCE
```

```shell
cp lab01-2.c lab01-2.c.bak
```

### mv

移動檔案或更改檔名

```shell
mv [OPTION] [-T] SOURCE DEST
mv [OPTION] SOURCE DIRECTORY
mv [OPTION] -t DIRECTORY SOURCE
```

```shell
mv lab01-2/Makefile lab01-2/Makefile
```


### cd

變換工作目錄

```shell
cd [DIRECTORY]
```

```shell
cd LAB01
```

### mkdir

建立目錄

```shell
mkdir [OPTION] DIRECTORY
```

```shell
mkdir LAB01
```

### rmdir

刪除目錄

```shell
rmdir [OPTION] DIRECTORY
```

```shell
rmdir LAB01
rmdir -r LAB01 	   # 刪除資料夾下的所有東西
rmdir -rf LAB01    # 強制刪除
```

### diff

比較兩個檔案的不同處

```shell
diff [OPTION] FILES
```

```shell
$ diff lab01-2/Makefile lab01-3/Makefile
4c4
< SRC    = lab01-2.c
---
> SRC    = lab01-3.c
```

### find

尋找檔案

```shell
find [-H] [-L] [-P] [-D debugopts] [-Olevel] [path] [expression]
```

```shell
$ find . -name "*.c"
./LAB01/lab01-2/lab01-2.c
./LAB01/lab01-4/lab01-4.c
./LAB01/lab01-3/lab01-3.c
```

### grep

找尋某個檔案中的字串

```shell
grep [OPTIONS] PATTERN [FILE]
grep [OPTIONS] [-e PATTERN | -f FILE] [FILE]
```

```shell
$ grep 'include' -nr ~/LAB01
/home/ESL_2016_01/LAB01/lab01-2/lab01-2.c:1:#include <stdio.h>
/home/ESL_2016_01/LAB01/lab01-4/lab01-4.c:1:#include <stdio.h>
/home/ESL_2016_01/LAB01/lab01-3/lab01-3.c:1:#include <stdio.h>
```

### tar

```shell
tar [-] A --catenate --concatenate | c --create | d --diff --compare | --delete | r --append | t --list | --test-label | u --update | x --extract --get [options] [pathname ]
```

```shell
# 壓縮
tar czvf lab.tgz LAB01/      # 把 LAB01 目錄壓成 lab.tgz
tar cvf lab.tgr LAB01/       # 建立 LAB01/ 目錄的保存檔 lab.tar


# 解壓縮
tar xzvf lab.tgz           # 將 lab.tgz 解壓縮
tar xvf lab.tar            # 將保存檔 lab.tar 解開
```

參數

- `-c`: 建立新的保存檔
- `-r`: 新增到保存檔的尾端，而不會重新建立保存檔
- `-t`: 列出保存檔所包含的檔案名稱
- `-u`: 更新檔案
- `-x`: 將指定的檔案名稱從保存檔中取出

### Vim 操作

![](images/vim-cheat-sheet-full.png)

[Image From Here: http://blog.vgod.tw.s3.amazonaws.com/wp-content/uploads/2009/12/vim-cheat-sheet-full.png](http://blog.vgod.tw.s3.amazonaws.com/wp-content/uploads/2009/12/vim-cheat-sheet-full.png)

### GCC

編譯 C/C++

```shell
gcc [-c|-S|-E] [-std=standard]
    [-g] [-pg] [-Olevel]
    [-Wwarn] [-Wpedantic]
    [-Idir] [-Ldir]
    [-Dmacro[=defn]] [-Umacro]
    [-foption] [-mmachine-option]
    [-o outfile] [@file] infile
```

```shell
gcc lab01-2.c
```

## Makefile

將編譯時的重複動作寫成腳本，自動化編譯。

```makefile
# LAB01/lab01-2/Makefile
CC     = gcc
EXE    = a.out
CFLAGS = -Wall -g -o $(EXE)
SRC    = lab01-2.c

all:
	$(CC) $(CFLAGS) $(SRC)
run:
	./$(EXE)
clean:
	rm -f $(EXE)
```

操作

```shell
make
make run
make clean
```
